# Unopposed

Tracks unopposed candidates in US elections (federal and state legislative races).

[View (Hosted on Github Pages)](https://danpozmanter.github.io/unopposed/)

## Structure

- `src/` - Svelte frontend
- `scraper/` - Python scraper using Ballotpedia
- `scripts/` - Development scripts
- `election_data/` - Scraped JSON data (generated by GitHub Actions or local scripts)

## Development

### Prerequisites

- Node.js 22+ with pnpm
- Python 3.10+ with uv

### Setup

```bash
pnpm install
cd scraper && uv sync
```

### Scripts

```bash
# Run frontend dev server
./scripts/run_ui.sh

# Lint and format all code
./scripts/lint.sh

# Python tests
./scripts/run_tests.sh

# Scrape data locally (single or multiple years)
./scripts/run_scrape_locally.sh 2026
./scripts/run_scrape_locally.sh 2025 2026
```

### Manual Commands

```bash
# Frontend
pnpm dev
pnpm build

# Scraper
cd scraper
uv run python main.py CA 2026 --json
uv run pytest
```

## GitHub Actions

### Scrape Workflow

Runs daily at 11pm UTC:
- Scrapes all 50 states + DC for the current year
- 10 second delay between states
- Commits results to `election_data/`

### Deploy Workflow

Triggered on push to `main`:
- Builds the Svelte app
- Copies `election_data/` to build output
- Deploys to GitHub Pages

To enable: set Pages source to "GitHub Actions" in repo settings.

## Data Format

Each state file (`election_data/{state}_{year}.json`):

```json
{
  "state": "CA",
  "state_name": "California",
  "year": 2026,
  "total": 5,
  "scraped_at": "2026-01-30T23:00:00Z",
  "unopposed_candidates": [
    {
      "state": "CA",
      "office": "US House",
      "district": "District 12",
      "candidate": "Jane Doe",
      "party": "Democrat",
      "unopposed_in": "Primary",
      "source": "Ballotpedia"
    }
  ]
}
```

Manifest file (`election_data/manifest.json`):

```json
{
  "years": [2025, 2026],
  "updated_at": "2026-01-30T23:00:00Z"
}
```

## Data Source

All data from [Ballotpedia](https://ballotpedia.org). May be incomplete. Verify with official sources.
